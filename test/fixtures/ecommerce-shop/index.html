<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechGear - Premium Tech Shop</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; color: #333; background: #f5f5f5; }
        header { background: white; padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .header-right { display: flex; gap: 20px; align-items: center; }
        .cart-count { background: #ff4444; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
        .products { padding: 40px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; }
        .product { background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .product-image { width: 100%; height: 250px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 3em; }
        .product-info { padding: 20px; }
        .product-name { font-size: 1.2em; font-weight: bold; margin-bottom: 10px; }
        .product-price { font-size: 1.5em; color: #ff4444; margin-bottom: 15px; }
        .product-desc { color: #666; margin-bottom: 15px; font-size: 0.9em; }
        .add-to-cart-btn { width: 100%; padding: 12px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
        .add-to-cart-btn:hover { background: #764ba2; }
        .added-message { display: none; color: green; font-size: 0.9em; margin-top: 8px; font-weight: bold; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
        .modal.active { display: flex; justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 40px; border-radius: 8px; width: 90%; max-width: 600px; max-height: 80vh; overflow-y: auto; }
        .modal h2 { margin-bottom: 20px; }
        .cart-item { display: flex; justify-content: space-between; padding: 15px; border-bottom: 1px solid #eee; }
        .cart-total { padding: 20px; font-size: 1.3em; font-weight: bold; margin-top: 20px; border-top: 2px solid #667eea; }
        .checkout-btn { width: 100%; padding: 15px; background: #ff4444; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 1.1em; margin-top: 20px; }
        .checkout-btn:hover { background: #cc0000; }
        .checkout-form { display: none; }
        .checkout-form.active { display: block; }
        input { padding: 10px; margin: 10px 0; width: 100%; border: 1px solid #ddd; border-radius: 4px; }
        .success-msg { display: none; color: green; font-weight: bold; margin: 20px 0; }
    </style>
</head>
<body>
    <header>
        <h1 style="margin: 0;">TechGear Store</h1>
        <div class="header-right">
            <div class="cart-count" id="cartCount">0</div>
            <button onclick="openCart()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer;">View Cart</button>
        </div>
    </header>

    <div class="products" id="products">
        <div class="product">
            <div class="product-image">ðŸ“±</div>
            <div class="product-info">
                <div class="product-name">ProPhone 15</div>
                <div class="product-price">$999</div>
                <div class="product-desc">Latest flagship smartphone with 5G connectivity</div>
                <button class="add-to-cart-btn" id="addCart1" data-cart-action="add" data-product-id="1" data-feedback="cart-update">Add to Cart</button>
                <div class="added-message">âœ“ Added to cart</div>
            </div>
        </div>

        <div class="product">
            <div class="product-image">âŒš</div>
            <div class="product-info">
                <div class="product-name">SmartWatch Pro</div>
                <div class="product-price">$399</div>
                <div class="product-desc">Fitness tracking with heart rate monitor</div>
                <button class="add-to-cart-btn" id="addCart2" data-cart-action="add" data-product-id="2" data-feedback="cart-update">Add to Cart</button>
                <div class="added-message">âœ“ Added to cart</div>
            </div>
        </div>

        <div class="product">
            <div class="product-image">ðŸŽ§</div>
            <div class="product-info">
                <div class="product-name">AudioPro Max</div>
                <div class="product-price">$349</div>
                <div class="product-desc">Noise-canceling wireless headphones</div>
                <button class="add-to-cart-btn" id="addCart3" data-cart-action="add" data-product-id="3" data-feedback="cart-update">Add to Cart</button>
                <div class="added-message">âœ“ Added to cart</div>
            </div>
        </div>
    </div>

    <div class="modal" id="cartModal">
        <div class="modal-content">
            <h2>Shopping Cart</h2>
            <div id="cartItems"></div>
            <div class="cart-total">Total: $<span id="totalPrice">0</span></div>
            <form id="checkoutForm" class="checkout-form" action="https://api.techgear.example/checkout" method="POST" data-feedback="order-confirmation" data-redirect="/order-complete.html">
                <h3 style="margin-top: 20px;">Shipping Address</h3>
                <input type="text" id="fullName" name="fullName" placeholder="Full Name" required>
                <input type="email" id="email" name="email" placeholder="Email" required>
                <input type="text" id="address" name="address" placeholder="Street Address" required>
                <input type="text" id="zipcode" name="zipcode" placeholder="Zip Code" required>
                <button type="submit" class="checkout-btn">Complete Purchase</button>
                <div class="success-msg" id="checkoutSuccess">âœ“ Order placed successfully!</div>
            </form>
            <button onclick="closeCart()" style="width: 100%; padding: 10px; background: #ccc; margin-top: 20px; border: none; border-radius: 4px; cursor: pointer;">Close</button>
        </div>
    </div>

    <script>
        let cart = [];

        function addToCart(id, name, price) {
            cart.push({ id, name, price });
            
            // INTENTIONAL BUG: Promise fires but UI is never updated
            fetch('https://api.techgear.example/cart/add', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ id, name, price })
            })
            .then(r => r.json())
            .then(data => {
                // INTENTIONAL: No feedback. Cart count doesn't update. No success message shows.
                // User has no idea if item was added
                // Cart state exists in JS, but visibility never changes
            })
            .catch(() => {
                // Silent fail
            });
            
            updateCartCount();
        }

        function updateCartCount() {
            document.getElementById('cartCount').textContent = cart.length;
        }

        function openCart() {
            document.getElementById('cartModal').classList.add('active');
            renderCart();
        }

        function closeCart() {
            document.getElementById('cartModal').classList.remove('active');
        }

        function renderCart() {
            const itemsDiv = document.getElementById('cartItems');
            if (cart.length === 0) {
                itemsDiv.innerHTML = '<p>Your cart is empty</p>';
                document.getElementById('checkoutForm').classList.remove('active');
                return;
            }
            
            itemsDiv.innerHTML = cart.map(item => 
                `<div class="cart-item"><span>${item.name}</span><span>$${item.price}</span></div>`
            ).join('');
            
            const total = cart.reduce((sum, item) => sum + item.price, 0);
            document.getElementById('totalPrice').textContent = total;
            document.getElementById('checkoutForm').classList.add('active');
        }

        function processCheckout() {
            const email = document.getElementById('email').value;
            if (!email) {
                alert('Please fill email');
                return;
            }

            // INTENTIONAL BUG: Same silent failure pattern in checkout
            fetch('https://api.techgear.example/checkout', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    items: cart,
                    email: email
                })
            })
            .then(r => r.json())
            .then(data => {
                // No success message appears, no redirect, cart never clears
            })
            .catch(() => {});
        }
    </script>
</body>
</html>
