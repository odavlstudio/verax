<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Phase 4 Authentication Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
    }
    h1 { color: #333; }
    form {
      margin: 20px 0;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    input, button {
      display: block;
      margin: 10px 0;
      padding: 8px;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 4px;
    }
    button:hover {
      background: #0056b3;
    }
    .protected-content {
      display: none;
      padding: 15px;
      background: #e8f4f8;
      border: 1px solid #007bff;
      border-radius: 4px;
      margin: 15px 0;
    }
    .protected-content.visible {
      display: block;
    }
    .logout-btn {
      background: #dc3545;
      width: auto;
      margin-top: 10px;
    }
    .logout-btn:hover {
      background: #c82333;
    }
    #login-status {
      padding: 10px;
      margin: 10px 0;
      background: #f0f0f0;
      border-radius: 4px;
    }
    #protected-route-status {
      padding: 10px;
      margin: 10px 0;
      background: #fff3cd;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Phase 4: Authentication Test</h1>
    
    <div id="login-section">
      <h2>Login Form</h2>
      <form id="login-form">
        <input type="email" id="email" placeholder="Email" required>
        <input type="password" id="password" placeholder="Password" required>
        <button type="submit">Login</button>
      </form>
      <div id="login-status">Not authenticated</div>
    </div>
    
    <div id="authenticated-section" style="display: none;">
      <h2>Welcome!</h2>
      <p id="login-greeting">You are authenticated.</p>
      <div class="protected-content visible">
        <h3>Protected Dashboard</h3>
        <p>This content is only visible when authenticated.</p>
        <ul>
          <li>User Profile</li>
          <li>Settings</li>
          <li>Preferences</li>
        </ul>
      </div>
      <button class="logout-btn" id="logout-btn">Logout</button>
    </div>
    
    <div id="protected-routes">
      <h2>Protected Routes</h2>
      <p>These links require authentication:</p>
      <ul>
        <li><a href="/admin/dashboard" id="admin-link">Admin Dashboard</a></li>
        <li><a href="/admin/settings" id="admin-settings">Admin Settings</a></li>
        <li><a href="/profile/account" id="profile-link">User Profile</a></li>
      </ul>
      <div id="protected-route-status">Check protected routes when authenticated</div>
    </div>
  </div>

  <script>
    // Simple in-memory authentication state
    const authState = {
      authenticated: false,
      email: null,
      token: 'verax-auth-token'
    };

    function updateUI() {
      const loginSection = document.getElementById('login-section');
      const authSection = document.getElementById('authenticated-section');
      const status = document.getElementById('login-status');
      
      if (authState.authenticated) {
        loginSection.style.display = 'none';
        authSection.style.display = 'block';
        status.textContent = 'Authenticated: ' + authState.email;
        localStorage.setItem('auth_token', authState.token);
        localStorage.setItem('auth_user', authState.email);
      } else {
        loginSection.style.display = 'block';
        authSection.style.display = 'none';
        status.textContent = 'Not authenticated';
        localStorage.removeItem('auth_token');
        localStorage.removeItem('auth_user');
      }
    }

    // Login form handler
    document.getElementById('login-form').addEventListener('submit', (e) => {
      e.preventDefault();
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      
      // Simulate login - for verax@example.com and VeraxPass123!
      if (email && password) {
        authState.authenticated = true;
        authState.email = email;
        updateUI();
      }
    });

    // Logout handler
    document.getElementById('logout-btn').addEventListener('click', () => {
      authState.authenticated = false;
      authState.email = null;
      document.getElementById('email').value = '';
      document.getElementById('password').value = '';
      updateUI();
    });

    // Protected route link handlers
    document.getElementById('admin-link').addEventListener('click', (e) => {
      e.preventDefault();
      const status = document.getElementById('protected-route-status');
      if (authState.authenticated) {
        status.textContent = 'Access granted to /admin/dashboard';
        status.style.background = '#d4edda';
      } else {
        status.textContent = 'Access denied: redirecting to login';
        status.style.background = '#f8d7da';
      }
    });

    document.getElementById('admin-settings').addEventListener('click', (e) => {
      e.preventDefault();
      const status = document.getElementById('protected-route-status');
      if (authState.authenticated) {
        status.textContent = 'Access granted to /admin/settings';
        status.style.background = '#d4edda';
      } else {
        status.textContent = 'Access denied: 403 Forbidden';
        status.style.background = '#f8d7da';
      }
    });

    document.getElementById('profile-link').addEventListener('click', (e) => {
      e.preventDefault();
      const status = document.getElementById('protected-route-status');
      if (authState.authenticated) {
        status.textContent = 'Access granted to /profile/account';
        status.style.background = '#d4edda';
      } else {
        status.textContent = 'Access denied: redirecting to login';
        status.style.background = '#f8d7da';
      }
    });

    // Initialize UI
    updateUI();
  </script>
</body>
</html>
